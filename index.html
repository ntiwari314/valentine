<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>рд╣рдорд╛рд░рд╛ рд╡реИрд▓реЗрдВрдЯрд╛рдЗрди | рд╣рдореЗрд╢рд╛ рдХреЗ рд▓рд┐рдП рд╕рд╛рде</title>
</head>
<body id="body" style="margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif, 'Noto Sans Devanagari'; background: #fff5f7; color: #4a0e0e; overflow-x: hidden; transition: background 0.5s ease;">

    <!-- PASSWORD PROTECTION OVERLAY -->
    <div id="auth-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #ff758f 0%, #ff4d6d 100%); z-index: 5000; display: flex; align-items: center; justify-content: center; transition: 0.8s ease-in-out;">
        <div class="glass" style="background: rgba(255, 255, 255, 0.2); padding: 40px; border-radius: 30px; text-align: center; width: 90%; max-width: 400px; border: 1px solid rgba(255,255,255,0.3); box-shadow: 0 10px 30px rgba(0,0,0,0.1);">
            <div style="font-size: 3rem; margin-bottom: 20px;">ЁЯФТ</div>
            <h2 style="color: white; margin-bottom: 10px;">рд╣рдорд╛рд░реА рджреБрдирд┐рдпрд╛</h2>
            <p style="color: white; opacity: 0.9; margin-bottom: 30px; font-size: 0.9rem;">рдкреНрд░рд╡реЗрд╢ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рд╕рд╡рд░реНрдб </p>
            <input type="password" id="pass-input" placeholder="рдкрд╛рд╕рд╡рд░реНрдб рдпрд╣рд╛рдБ рд▓рд┐рдЦреЗрдВ..." style="width: 100%; padding: 15px; border-radius: 50px; border: none; outline: none; margin-bottom: 20px; text-align: center; font-size: 1.1rem; box-sizing: border-box;">
            <button onclick="checkPassword()" style="width: 100%; padding: 15px; border-radius: 50px; border: none; background: white; color: #ff4d6d; font-weight: bold; cursor: pointer; font-size: 1rem; transition: 0.3s;">рдкреНрд░рд╡реЗрд╢ рдХрд░реЗрдВ ЁЯТЦ</button>
            <p id="error-msg" style="color: #fff; margin-top: 15px; font-size: 0.8rem; display: none; background: rgba(0,0,0,0.1); padding: 10px; border-radius: 10px;">рдЧрд▓рдд рдкрд╛рд╕рд╡рд░реНрдб! рдлрд┐рд░ рд╕реЗ рдХреЛрд╢рд┐рд╢ рдХрд░реЗрдВред</p>
        </div>
    </div>

    <!-- APP STATE & LOGIC INJECTOR -->
    <script>
        const state = {
            nameA: "рдЦреБрд╢реА",
            nameB: "рдирд┐рддрд┐рди",
            customMessage: "рдЦреБрд╢реА, рдореЗрд░рд╛ рддреБрдорд╕реЗ рдпреЗ рд╡рд╛рджрд╛ рд╣реИ рдХрд┐ рдЪрд╛рд╣реЗ рд╡рдХреНрдд рдХреИрд╕рд╛ рднреА рд╣реЛ, рдореИрдВ рдХрднреА рддреБрдореНрд╣рд╛рд░рд╛ рд╕рд╛рде рдирд╣реАрдВ рдЫреЛрдбрд╝реВрдБрдЧрд╛ред рддреБрдо рдореЗрд░реА рдЬрд╝рд┐рдиреНрджрдЧреА рдХреА рд╕рдмрд╕реЗ рдмрдбрд╝реА рдЦреБрд╢реА рд╣реЛ рдФрд░ рдореИрдВ рдорд░рддреЗ рджрдо рддрдХ рд╕рд┐рд░реНрдл рддреБрдореНрд╣рд╛рд░рд╛ рдмрдирдХрд░ рд░рд╣реВрдБрдЧрд╛ред рд╣рдо рд╕рд╛рде рд╣реИрдВ, рдФрд░ рд╣рдореЗрд╢рд╛ рд╕рд╛рде рд░рд╣реЗрдВрдЧреЗред", 
            theme: 'romantic', 
            particlesEnabled: true,
            soundEnabled: true,
            isTogether: false,
            appId: 'val-2025'
        };

        const themes = {
            romantic: {
                bg: 'linear-gradient(135deg, #fff5f7 0%, #ffe3e8 100%)',
                primary: '#ff4d6d',
                secondary: '#ff758f',
                accent: '#c9184a',
                text: '#590d22',
                glass: 'rgba(255, 255, 255, 0.8)'
            }
        };

        const styleTag = document.createElement('style');
        styleTag.innerHTML = `
            @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;700&display=swap');
            @keyframes float { 0% { transform: translateY(0px) rotate(0deg); opacity: 0; } 50% { opacity: 0.8; } 100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; } }
            @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 77, 109, 0.7); } 70% { transform: scale(1.05); box-shadow: 0 0 0 15px rgba(255, 77, 109, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(255, 77, 109, 0); } }
            @keyframes slideIn { from { transform: translateX(120%); } to { transform: translateX(0); } }
            @keyframes glow { 0%, 100% { border-color: var(--primary); box-shadow: 0 0 5px var(--primary); } 50% { border-color: var(--accent); box-shadow: 0 0 20px var(--accent); } }
            @keyframes successSnap { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
            
            .reveal { opacity: 0; transition: all 0.8s ease-out; transform: translateY(30px); }
            .reveal.active { opacity: 1; transform: translateY(0); }
            .glass { backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); }
            .no-select { -webkit-user-select: none; user-select: none; }
            html { scroll-behavior: smooth; }
            body { font-family: 'Noto Sans Devanagari', sans-serif; }
            .photo-slot { transition: transform 0.3s ease; cursor: pointer; }
            .photo-slot:hover { transform: scale(1.02); }

            /* GAME STYLES */
            .game-piece {
                width: 140px;
                height: 200px;
                background: #fff;
                position: absolute;
                cursor: grab;
                overflow: hidden;
                box-shadow: 0 10px 20px rgba(0,0,0,0.1);
                display: flex;
                align-items: center;
                justify-content: center;
                transition: opacity 0.3s, border-radius 0.5s;
                z-index: 10;
            }
            .game-piece img {
                width: 100%;
                height: 100%;
                object-fit: cover;
                opacity: 0.6;
                pointer-events: none;
                transition: opacity 0.5s;
            }
            .game-piece.snapped img {
                opacity: 1;
            }
            .left-piece { border-radius: 15px 0 0 15px; }
            .right-piece { border-radius: 0 15px 15px 0; }
            
            img { max-width: 100%; height: auto; display: block; }
            .placeholder-img { width: 100%; height: 100%; object-fit: cover; }
        `;
        document.head.appendChild(styleTag);

        const $ = (id) => document.getElementById(id);

        function checkPassword() {
            const input = $('pass-input').value.toLowerCase().trim();
            if (input === 'khushi') {
                const overlay = $('auth-overlay');
                overlay.style.opacity = '0';
                overlay.style.pointerEvents = 'none';
                playTone(523.25, 'sine', 0.5);
                showToast("рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ, рдЦреБрд╢реА! ЁЯТЦ");
                initUI();
            } else {
                $('error-msg').style.display = 'block';
                $('pass-input').value = '';
                playTone(220, 'square', 0.3);
            }
        }

        const playTone = (freq, type = 'sine', duration = 0.2) => {
            if (!state.soundEnabled) return;
            try {
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const osc = ctx.createOscillator();
                const gain = ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, ctx.currentTime);
                gain.gain.setValueAtTime(0.1, ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(ctx.destination);
                osc.start();
                osc.stop(ctx.currentTime + duration);
            } catch(e) {}
        };

        const showToast = (msg) => {
            const toast = document.createElement('div');
            toast.innerText = msg;
            Object.assign(toast.style, {
                position: 'fixed', bottom: '20px', right: '20px', padding: '12px 24px',
                background: themes[state.theme].primary, color: 'white', borderRadius: '50px',
                boxShadow: '0 4px 15px rgba(0,0,0,0.2)', zIndex: '9999',
                animation: 'slideIn 0.3s ease-out', fontWeight: 'bold'
            });
            document.body.appendChild(toast);
            setTimeout(() => {
                toast.style.transform = 'translateX(150%)';
                toast.style.transition = '0.5s';
                setTimeout(() => toast.remove(), 500);
            }, 3000);
        };

        const confettiBurst = (x, y) => {
            const emojis = ['ЁЯТЦ', 'тЬи', 'ЁЯМ╣', 'ЁЯТШ', 'ЁЯНл', 'ЁЯМ╕'];
            for (let i = 0; i < 20; i++) {
                const el = document.createElement('div');
                el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
                Object.assign(el.style, {
                    position: 'fixed', left: x + 'px', top: y + 'px',
                    pointerEvents: 'none', zIndex: '10000', fontSize: '24px',
                    transition: 'all 1s cubic-bezier(0.1, 0.5, 0.5, 1)'
                });
                document.body.appendChild(el);
                const tx = (Math.random() - 0.5) * 400;
                const ty = (Math.random() - 0.5) * 400;
                requestAnimationFrame(() => {
                    el.style.transform = `translate(${tx}px, ${ty}px) rotate(${Math.random() * 360}deg)`;
                    el.style.opacity = '0';
                });
                setTimeout(() => el.remove(), 1000);
            }
        };

        const createParticles = () => {
            if (!state.particlesEnabled) return;
            const container = $('particle-container');
            const particle = document.createElement('div');
            const isHeart = Math.random() > 0.3;
            particle.innerHTML = isHeart ? 'тЭдя╕П' : 'тЬи';
            Object.assign(particle.style, {
                position: 'fixed', bottom: '-50px', left: Math.random() * 100 + 'vw',
                fontSize: (10 + Math.random() * 20) + 'px', opacity: '0',
                animation: `float ${5 + Math.random() * 5}s linear forwards`,
                zIndex: '0', pointerEvents: 'none'
            });
            container.appendChild(particle);
            setTimeout(() => particle.remove(), 10000);
        };

        const setTheme = (themeName) => {
            state.theme = themeName;
            const t = themes[themeName];
            document.body.style.background = t.bg;
            document.body.style.color = t.text;
            const bgElements = document.querySelectorAll('.theme-bg');
            bgElements.forEach(el => el.style.background = t.primary);
        };
    </script>

    <!-- FLOATING BACKGROUND -->
    <div id="particle-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;"></div>

    <!-- NAVIGATION -->
    <nav id="navbar" class="glass" style="position: fixed; top: 0; width: 100%; height: 60px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 1000; box-sizing: border-box; border-bottom: 1px solid rgba(255,255,255,0.2);">
        <div style="font-weight: bold; font-size: 1.2rem; cursor: pointer;" onclick="window.scrollTo(0,0)">
            ЁЯТЦ <span id="nav-names">рд╣рдо</span>
        </div>
        <div style="display: flex; gap: 15px; font-size: 0.9rem;">
            <a href="#about" style="text-decoration: none; color: inherit;">рдХрд╣рд╛рдиреА</a>
            <a href="#together" style="text-decoration: none; color: inherit;">рдпрд╛рджреЗрдВ</a>
            <a href="#games" style="text-decoration: none; color: inherit;">рдЦреЗрд▓</a>
            <a href="#note" style="text-decoration: none; color: inherit;">рд╡рд╛рджреЗ</a>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main style="max-width: 1000px; margin: 0 auto; padding: 80px 20px;">
        <!-- HERO -->
        <section id="hero" class="reveal active" style="text-align: center; padding: 40px 0;">
            <div style="font-size: 4rem; margin-bottom: 10px;">ЁЯТЭ</div>
            <h1 id="hero-title" style="font-size: 3rem; margin: 0; line-height: 1.1;">рдореЗрд░реЗ рд╡реИрд▓реЗрдВрдЯрд╛рдЗрди рдХреЗ рд▓рд┐рдП</h1>
            <p id="hero-subtext" style="font-size: 1.2rem; opacity: 0.8; max-width: 600px; margin: 20px auto;">рддреБрдореНрд╣рд╛рд░реЗ рд╕рд╛рде рдмрд┐рддрд╛рдпрд╛ рд╣рд░ рдкрд▓ рдПрдХ рдЦреВрдмрд╕реВрд░рдд рд╡рд╛рджрд╛ рд╣реИред</p>
            <div style="display: flex; justify-content: center; gap: 15px; margin-top: 30px;">
                <button onclick="openModal()" class="theme-bg" style="padding: 15px 30px; border: none; border-radius: 50px; color: white; font-weight: bold; cursor: pointer; animation: pulse 2s infinite;">рдкреНрд░реЗрдо рдкрддреНрд░ рдЦреЛрд▓реЗрдВ ЁЯТМ</button>
                <button onclick="surpriseBurst(event)" style="padding: 15px 30px; border: 2px solid #ff4d6d; border-radius: 50px; background: transparent; font-weight: bold; cursor: pointer;">рд╕рд░рдкреНрд░рд╛рдЗрдЬ ЁЯОЙ</button>
            </div>
        </section>

        <!-- PHOTO SECTION -->
        <section id="photos" class="reveal" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; padding: 40px 0;">
            <div class="glass" style="padding: 20px; border-radius: 15px; border: 3px dashed #ff4d6d; text-align: center; animation: glow 3s infinite;">
                <h4 id="labelA" style="margin-top: 0;">рдЦреБрд╢реА</h4>
                <div id="previewA" style="width: 100%; aspect-ratio: 1; background: #eee; border-radius: 10px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 15px;">
                    <img id="imgA" src="https://images.unsplash.com/photo-1518893063132-36e46dbe2428?q=80&w=400&h=400&fit=crop" class="placeholder-img" alt="рдЦреБрд╢реА">
                </div>
                <button onclick="$('uploadA').click()" style="background: #eee; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">рдмрджрд▓реЗрдВ</button>
                <input type="file" id="uploadA" hidden onchange="handleImage(this, 'previewA')">
            </div>

            <div class="glass" style="padding: 20px; border-radius: 15px; border: 3px dashed #ff4d6d; text-align: center; animation: glow 3s infinite 1.5s;">
                <h4 id="labelB" style="margin-top: 0;">рдирд┐рддрд┐рди</h4>
                <div id="previewB" style="width: 100%; aspect-ratio: 1; background: #eee; border-radius: 10px; display: flex; align-items: center; justify-content: center; overflow: hidden; margin-bottom: 15px;">
                    <img id="imgB" src="https://images.unsplash.com/photo-1492633423870-43d1cd2775eb?q=80&w=400&h=400&fit=crop" class="placeholder-img" alt="рдирд┐рддрд┐рди">
                </div>
                <button onclick="$('uploadB').click()" style="background: #eee; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">рдмрджрд▓реЗрдВ</button>
                <input type="file" id="uploadB" hidden onchange="handleImage(this, 'previewB')">
            </div>
        </section>

        <!-- JOINING GAME SECTION -->
        <section id="games" class="reveal" style="padding: 60px 0;">
            <h2 style="text-align: center;">рд╣рдореЗрдВ рдПрдХ рд╕рд╛рде рд▓рд╛рдПрдВ ЁЯТШ</h2>
            <p style="text-align: center; opacity: 0.7; margin-bottom: 20px;">рджреЛрдиреЛрдВ рддрд╕реНрд╡реАрд░реЛрдВ рдХреЛ рдПрдХ рджреВрд╕рд░реЗ рдХреЗ рдХрд░реАрдм рдЦреАрдВрдЪреЗрдВ (Snap pieces together!)</p>
            <div id="game-canvas" style="height: 400px; background: rgba(0,0,0,0.03); border-radius: 20px; position: relative; touch-action: none; overflow: hidden; border: 1px solid rgba(0,0,0,0.05);">
                <!-- Card A (Left side) -->
                <div id="cardA" class="no-select game-piece left-piece" style="top: 50px; left: 30px;">
                    <div id="cardInnerA" style="width: 100%; height: 100%;">
                        <img id="gameImgA" src="https://images.unsplash.com/photo-1518893063132-36e46dbe2428?q=80&w=280&h=400&fit=crop" alt="Left Half">
                    </div>
                </div>
                <!-- Card B (Right side) -->
                <div id="cardB" class="no-select game-piece right-piece" style="bottom: 50px; right: 30px;">
                    <div id="cardInnerB" style="width: 100%; height: 100%;">
                        <img id="gameImgB" src="https://images.unsplash.com/photo-1492633423870-43d1cd2775eb?q=80&w=280&h=400&fit=crop" alt="Right Half">
                    </div>
                </div>
                <div id="match-badge" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); transition: 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 100; font-size: 2rem; font-weight: bold; text-align: center; width: 100%; pointer-events: none; color: #ff0040; text-shadow: 0 2px 10px rgba(255,255,255,0.8);">
                     ЁЯТЦ
                </div>
            </div>
        </section>

        <!-- TOGETHER SECTION -->
        <section id="together" class="reveal" style="padding: 60px 0; text-align: center;">
            <h2 style="font-size: 2rem; margin-bottom: 20px;">рд╣рдорд╛рд░реА рдЦреВрдмрд╕реВрд░рдд рдпрд╛рджреЗрдВ ЁЯУ╕</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                <div class="glass photo-slot" style="padding: 10px; border-radius: 15px; background: white;" onclick="$('uploadShared1').click()">
                    <div id="sharedPrev1" style="width: 100%; aspect-ratio: 4/5; background: #f9f9f9; border-radius: 10px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                        <img src="https://images.unsplash.com/photo-1516589174184-c68d8e21e27d?q=80&w=300&h=400&fit=crop" class="placeholder-img" alt="Memory 1">
                    </div>
                    <input type="file" id="uploadShared1" hidden onchange="handleImage(this, 'sharedPrev1')">
                </div>
                <div class="glass photo-slot" style="padding: 10px; border-radius: 15px; background: white;" onclick="$('uploadShared2').click()">
                    <div id="sharedPrev2" style="width: 100%; aspect-ratio: 4/5; background: #f9f9f9; border-radius: 10px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                        <img src="https://images.unsplash.com/photo-1529636760656-e09213d095bc?q=80&w=300&h=400&fit=crop" class="placeholder-img" alt="Memory 2">
                    </div>
                    <input type="file" id="uploadShared2" hidden onchange="handleImage(this, 'sharedPrev2')">
                </div>
                <div class="glass photo-slot" style="padding: 10px; border-radius: 15px; background: white;" onclick="$('uploadShared3').click()">
                    <div id="sharedPrev3" style="width: 100%; aspect-ratio: 4/5; background: #f9f9f9; border-radius: 10px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                        <img src="https://images.unsplash.com/photo-1474552226712-ac0f0961a954?q=80&w=300&h=400&fit=crop" class="placeholder-img" alt="Memory 3">
                    </div>
                    <input type="file" id="uploadShared3" hidden onchange="handleImage(this, 'sharedPrev3')">
                </div>
            </div>
        </section>

        <!-- MESSAGE SECTION -->
        <section id="about" class="reveal" style="padding: 60px 0; text-align: center;">
            <h2 style="font-size: 2rem;">рд╡рд╛рджрд╛ рдЙрдореНрд░ рднрд░ рдХрд╛</h2>
            <div style="font-size: 1.1rem; line-height: 1.8; max-width: 700px; margin: 0 auto;">
                <p id="displayMsg"></p>
                <blockquote style="font-style: italic; border-left: 4px solid #ff4d6d; padding: 20px; background: rgba(255, 77, 109, 0.05); border-radius: 0 15px 15px 0;">
                    "рд╣рдорд╛рд░рд╛ рдкреНрдпрд╛рд░ рд╡рдХреНрдд рдХреЗ рд╕рд╛рде рдФрд░ рднреА рдЧрд╣рд░рд╛ рд╣реЛрдЧрд╛ред"
                </blockquote>
            </div>
        </section>

        <!-- PROMISES SECTION -->
        <section id="note" class="reveal" style="padding: 60px 0; text-align: center;">
            <div class="glass" style="padding: 40px; border-radius: 30px;">
                <h2>рд╕рд╛рдд рд╡рдЪрди ЁЯТМ</h2>
                <div id="generated-note" style="min-height: 100px; font-size: 1.2rem; padding: 20px; border-radius: 15px; background: white; margin-bottom: 20px; display: flex; align-items: center; justify-content: center;">рд╡рд╛рджрд╛ рдХрд░реЗрдВ...</div>
                <button onclick="generateNote()" class="theme-bg" style="padding: 12px 24px; border: none; border-radius: 50px; color: white; font-weight: bold; cursor: pointer;">рдирдпрд╛ рд╡рд╛рджрд╛</button>
            </div>
        </section>
    </main>

    <footer style="padding: 60px 20px; text-align: center;">
        <p>&copy; 2025 рдЦреБрд╢реА рдФрд░ рдирд┐рддрд┐рди рдХрд╛ рдЕрдЯреВрдЯ рдкреНрдпрд╛рд░</p>
    </footer>

    <!-- MODAL -->
    <div id="modal-overlay" onclick="closeModal()" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; display: none; align-items: center; justify-content: center;">
        <div id="modal-content" class="glass" style="width: 90%; max-width: 500px; padding: 40px; border-radius: 20px; background: white; transform: scale(0.8); transition: 0.3s; opacity: 0;" onclick="event.stopPropagation()">
            <h2 id="modal-title">рдореЗрд░реА рдЦреБрд╢реА рдХреЗ рд▓рд┐рдП</h2>
            <div id="typed-text" style="line-height: 1.6; font-size: 1.1rem; white-space: pre-wrap;"></div>
            <p style="text-align: right; margin-top: 20px; font-weight: bold;">рддреБрдореНрд╣рд╛рд░рд╛, рдирд┐рддрд┐рди</p>
        </div>
    </div>

    <script>
        let isSnapped = false;

        function initUI() {
            setTheme(state.theme);
            $('displayMsg').innerText = state.customMessage;
            updateNames();
            setupDraggable('cardA');
            setupDraggable('cardB');
            setInterval(createParticles, 300);
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('active'); });
            }, { threshold: 0.1 });
            document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
        }

        function updateNames() {
            $('nav-names').innerText = `${state.nameA} рдФрд░ ${state.nameB}`;
            $('hero-title').innerText = `рдореЗрд░реА ${state.nameA} рдХреЗ рд▓рд┐рдП`;
            $('labelA').innerText = state.nameA;
            $('labelB').innerText = state.nameB;
        }

        function handleImage(input, previewId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const prev = $(previewId);
                    const imgHtml = `<img src="${e.target.result}" class="placeholder-img" style="width:100%;height:100%;object-fit:cover;">`;
                    prev.innerHTML = imgHtml;
                    
                    if (previewId === 'previewA') $('cardInnerA').innerHTML = imgHtml;
                    if (previewId === 'previewB') $('cardInnerB').innerHTML = imgHtml;
                    
                    showToast("рдлреЛрдЯреЛ рдЕрдкрдбреЗрдЯ рд╣реЛ рдЧрдИ! ЁЯУ╕");
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function openModal() {
            const overlay = $('modal-overlay');
            const content = $('modal-content');
            overlay.style.display = 'flex';
            setTimeout(() => { content.style.opacity = '1'; content.style.transform = 'scale(1)'; }, 10);
            
            const text = state.customMessage;
            const target = $('typed-text');
            target.innerHTML = '';
            let i = 0;
            const timer = setInterval(() => {
                target.innerHTML += text.charAt(i); i++;
                if (i >= text.length) clearInterval(timer);
            }, 30);
        }

        function closeModal() { $('modal-overlay').style.display = 'none'; }
        function surpriseBurst(e) { confettiBurst(e.clientX, e.clientY); showToast("рд╣рдореЗрд╢рд╛ рд╕рд╛рде рд░рд╣реЗрдВрдЧреЗ! тЬи"); }

        function setupDraggable(id) {
            const el = $(id);
            let active = false, currentX = 0, currentY = 0, initialX, initialY, xOffset = 0, yOffset = 0;
            
            const dragStart = (e) => {
                if(isSnapped) return;
                const ev = e.type === "touchstart" ? e.touches[0] : e;
                initialX = ev.clientX - xOffset; 
                initialY = ev.clientY - yOffset;
                if (e.target === el || el.contains(e.target)) {
                    active = true;
                    el.style.zIndex = "50";
                }
            };
            
            const dragEnd = () => { 
                if(isSnapped) return;
                initialX = currentX; 
                initialY = currentY; 
                active = false; 
                el.style.zIndex = "10";
                checkSnap(); 
            };
            
            const drag = (e) => {
                if (active && !isSnapped) {
                    e.preventDefault();
                    const ev = e.type === "touchmove" ? e.touches[0] : e;
                    currentX = ev.clientX - initialX; 
                    currentY = ev.clientY - initialY;
                    xOffset = currentX; 
                    yOffset = currentY;
                    el.style.transform = `translate3d(${currentX}px, ${currentY}px, 0)`;
                }
            };

            el.addEventListener("mousedown", dragStart); 
            document.addEventListener("mouseup", dragEnd); 
            document.addEventListener("mousemove", drag);
            el.addEventListener("touchstart", dragStart); 
            document.addEventListener("touchend", dragEnd); 
            document.addEventListener("touchmove", drag, {passive: false});
        }

        function checkSnap() {
            if(isSnapped) return;
            const a = $('cardA').getBoundingClientRect();
            const b = $('cardB').getBoundingClientRect();
            
            const horizontalGap = b.left - a.right;
            const verticalDiff = Math.abs(a.top - b.top);

            if (horizontalGap < 20 && horizontalGap > -40 && verticalDiff < 40) {
                triggerSnap();
            }
        }

        function triggerSnap() {
            isSnapped = true;
            const cardA = $('cardA');
            const cardB = $('cardB');
            const canvas = $('game-canvas').getBoundingClientRect();
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;

            cardA.style.transition = "all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
            cardB.style.transition = "all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)";

            cardA.style.left = (centerX - 140) + "px";
            cardA.style.top = (centerY - 100) + "px";
            cardA.style.transform = "translate3d(0, 0, 0)";

            cardB.style.left = centerX + "px";
            cardB.style.top = (centerY - 100) + "px";
            cardB.style.transform = "translate3d(0, 0, 0)";

            setTimeout(() => {
                cardA.classList.add('snapped');
                cardB.classList.add('snapped');
                cardA.style.animation = "successSnap 0.5s ease";
                cardB.style.animation = "successSnap 0.5s ease";
                
                $('match-badge').style.transform = 'translate(-50%, -50%) scale(1)';
                confettiBurst(canvas.left + centerX, canvas.top + centerY);
                playTone(523.25, 'sine', 0.5);
            }, 500);
        }

        const promises = [
            "рдореИрдВ рд╡рд╛рджрд╛ рдХрд░рддрд╛ рд╣реВрдБ рдХрд┐ рдореИрдВ рдХрднреА рддреБрдореНрд╣рд╛рд░рд╛ рд╣рд╛рде рдирд╣реАрдВ рдЫреЛрдбрд╝реВрдБрдЧрд╛ред",
            "рд╣рдорд╛рд░рд╛ рдкреНрдпрд╛рд░ рд╡рдХреНрдд рдХреЗ рд╕рд╛рде рдФрд░ рднреА рдЧрд╣рд░рд╛ рд╣реЛрддрд╛ рдЬрд╛рдПрдЧрд╛ред",
            "рдмреБрдврд╝рд╛рдкреЗ рддрдХ рд╣рдо рдРрд╕реЗ рд╣реА рдПрдХ рджреВрд╕рд░реЗ рдХрд╛ рд╣рд╛рде рдерд╛рдореЗ рд░рд╣реЗрдВрдЧреЗред",
            "рддреБрдо рдореЗрд░реА рдкрд╣рд▓реА рдФрд░ рдЖрдЦрд┐рд░реА рдореЛрд╣рдмреНрдмрдд рд╣реЛ рдФрд░ рд░рд╣реЛрдЧреАред"
        ];
        function generateNote() { $('generated-note').innerText = promises[Math.floor(Math.random() * promises.length)]; }

        window.addEventListener('load', () => $('pass-input').focus());
        $('pass-input').addEventListener('keypress', (e) => { if (e.key === 'Enter') checkPassword(); });
    </script>
</body>
</html>
